LAMMPS (7 Aug 2019)
# 2d rounded polygon bodies

variable    r     index 4
variable    steps index 100000
variable    T     index 0.5
variable    P     index 0.1
variable    seed  index 980411

units       lj
dimension   2

atom_style  body rounded/polygon 1 6
atom_modify map array
read_data   data.squares
  orthogonal box = (0 0 -0.5) to (12 12 0.5)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  2 atoms
  2 bodies
  read_data CPU = 0.001464 secs

replicate   $r $r 1
replicate   4 $r 1
replicate   4 4 1
  orthogonal box = (0 0 -0.5) to (48 48 0.5)
  1 by 1 by 1 MPI processor grid
  32 atoms
  replicate CPU = 0.000163 secs

velocity    all create $T ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 980411 dist gaussian mom yes rot yes

change_box  all boundary p f p

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 2
variable c_n        equal 0.1
variable c_t        equal 0.1
variable mu         equal 0.1
variable delta_ua   equal 0.5

pair_style body/rounded/polygon ${c_n} ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 0.5 ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 0.5 0.5
pair_coeff * * ${k_n} ${k_na}
pair_coeff * * 100 ${k_na}
pair_coeff * * 100 2

comm_modify vel yes

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

#fix         1 all nve/body
#fix         1 all nvt/body temp $T $T 1.0
fix          1 all npt/body temp $T $T 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 $T 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0 fixedpoint 0 0 0

fix          2 all enforce2d
fix          3 all wall/body/polygon 2000 50 50 yplane 0.0 48.0

#compute      1 all body/local id 1 2 3
#dump         1 all local 100000 dump.polygon.* index c_1[1] c_1[2] c_1[3] c_1[4]

thermo_style custom step ke pe etotal press
thermo       1000

#dump	     2 all image 10000 image.*.jpg type type zoom 2.0 #             adiam 1.5 body type 0 0
#dump_modify  2 pad 6
dump        3 all movie 100 movie.mpg type type
run          ${steps}
run          100000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.15685
  ghost atom cutoff = 6.15685
  binsize = 3.07843, bins = 16 16 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair body/rounded/polygon, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d/newton
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.99 | 4.99 | 4.99 Mbytes
Step KinEng PotEng TotEng Press 
       0     0.484375         0.25     0.734375 0.0067274306 
    1000   0.51454099 0.0010113473   0.51555234    0.0135084 
    2000   0.55700956 0.0040149681   0.56102453 0.0034530946 
    3000   0.75468232  0.022581261   0.77726358 0.0036505085 
    4000   0.72833169  0.098211499   0.82654318 0.0055126227 
    5000   0.53461989  0.093063225   0.62768312   0.01223752 
    6000   0.55486631  0.073859021   0.62872533   0.01120594 
    7000    0.4903158  0.054397978   0.54471378 0.0025185253 
    8000   0.52967166  0.032291997   0.56196366 0.0031990176 
    9000   0.46171442   0.11545579   0.57717022  0.012900467 
   10000   0.46799184  0.060316742   0.52830859  0.010089962 
   11000   0.47081471   0.13092308   0.60173778 3.2725306e-05 
   12000   0.47080784  0.098689918   0.56949776 5.3081805e-05 
   13000   0.76513116   0.22218906   0.98732023  0.039210033 
   14000   0.43605639   0.10874286   0.54479924 -0.00014986468 
   15000    0.4347116   0.14406476   0.57877636  0.019429438 
   16000    0.5264621   0.12009573   0.64655783  0.015829824 
   17000   0.64841732   0.14505484   0.79347216  0.035865309 
   18000   0.46434391   0.15254917   0.61689308 0.0011100789 
   19000   0.33740418   0.11245677   0.44986095 -0.0044728223 
   20000    0.4500131   0.24185711   0.69187021 0.0081545241 
   21000    0.5483732   0.15760847   0.70598167  0.019262353 
   22000   0.52432171  0.067005714   0.59132742  0.021645081 
   23000   0.47292345  0.093327022   0.56625047 0.0061817109 
   24000   0.37756867   0.10014625   0.47771491 -0.00083723515 
   25000   0.46349289   0.25347908   0.71697197 0.0019923199 
   26000   0.41657901   0.14543891   0.56201792   0.02037812 
   27000    0.4528902   0.22086493   0.67375513  0.051742031 
   28000   0.40831101   0.16614445   0.57445546  0.023184418 
   29000   0.59594443   0.12682123   0.72276565   0.02874745 
   30000    0.4529618   0.18219383   0.63515564  0.029839956 
   31000   0.46440765    0.2126834   0.67709106  0.016839588 
   32000   0.61758351   0.23453761   0.85212112  0.046110089 
   33000   0.66279683   0.21158817     0.874385  0.056281097 
   34000   0.56122697   0.24388188   0.80510886 0.0014095143 
   35000   0.43802183   0.30998861   0.74801044  0.055945431 
   36000   0.53385708   0.23264691   0.76650398  0.021221794 
   37000   0.53665072   0.40417214   0.94082286  0.026919575 
   38000   0.41345067   0.32900133   0.74245199  0.042966772 
   39000   0.55944087   0.25831006   0.81775093  0.061415339 
   40000   0.44904879   0.30719744   0.75624623  0.046483344 
   41000   0.48081969    0.2483666   0.72918629 -0.0080329791 
   42000    0.4029623   0.23691326   0.63987556  0.058091998 
   43000    0.4945626   0.26588737   0.76044998 0.00093522441 
   44000   0.58143378   0.44689602    1.0283298  0.067216754 
   45000   0.46968741   0.34838875   0.81807616  0.017155122 
   46000   0.37408326   0.33065558   0.70473884   0.01930426 
   47000   0.66756678   0.47952581    1.1470926  0.062390625 
   48000   0.64138566   0.30803538   0.94942103  0.084278026 
   49000   0.60054629   0.27187524   0.87242153 -0.028539801 
   50000   0.57770504   0.30618366    0.8838887  0.048578067 
   51000   0.56812377   0.44785068    1.0159745  0.070050056 
   52000   0.63411267   0.36769375    1.0018064 -0.0027127287 
   53000    0.6304337   0.41921028     1.049644   0.20927956 
   54000   0.59346092   0.37963009     0.973091  0.070420732 
   55000   0.47567607   0.36448846   0.84016454 -0.0079495384 
   56000   0.54044491   0.53094054    1.0713854   0.11581607 
   57000   0.53115299   0.33368515   0.86483814   0.11716584 
   58000   0.60774812   0.35198839   0.95973651  0.050529155 
   59000   0.53034785   0.40017024   0.93051809   0.08478591 
   60000   0.57319826   0.44065088    1.0138491   0.11550497 
   61000   0.55201736   0.32263961   0.87465697  0.068253575 
   62000   0.69490572   0.37862906    1.0735348  0.019332086 
   63000   0.68491323   0.46436988    1.1492831  0.057485688 
   64000   0.59873042   0.33076981   0.92950023  0.031186824 
   65000   0.47326033   0.46923189   0.94249222   0.10138322 
   66000   0.42228313   0.71780126    1.1400844   0.16558062 
   67000   0.68861991   0.43550504     1.124125   0.10070097 
   68000   0.58898641   0.55797068    1.1469571  0.026276958 
   69000   0.42578159    0.3660804   0.79186199  0.012970659 
   70000   0.49826769   0.49066008   0.98892776  0.038027234 
   71000    0.7367875   0.53511534    1.2719028  0.045575671 
   72000   0.52721589   0.55443993    1.0816558  0.049661616 
   73000    0.5064755   0.50427765    1.0107531  0.042483174 
   74000   0.65615602   0.62329633    1.2794524   0.22871981 
   75000   0.70640893   0.42969232    1.1361013  0.030906637 
   76000   0.50368173   0.56550694    1.0691887  0.037194157 
   77000   0.49920969   0.51209087    1.0113006  0.054842367 
   78000   0.61591646   0.58071713    1.1966336  0.022144857 
   79000   0.64130435   0.38615893    1.0274633  0.091200788 
   80000   0.59442583   0.44862319     1.043049  0.046092627 
   81000   0.69528873   0.54375467    1.2390434   0.11047297 
   82000   0.66300907   0.63190896     1.294918  0.091779111 
   83000   0.51568918   0.48607316    1.0017623  0.012767324 
   84000   0.56330191   0.64287929    1.2061812  0.058118717 
   85000   0.60397195   0.46436534    1.0683373   0.11030462 
   86000   0.61244532    0.4703365    1.0827818  0.064475922 
   87000   0.56525904   0.45107625    1.0163353 -0.0009146275 
   88000   0.71333235   0.47722304    1.1905554  0.013226285 
   89000   0.56525773   0.57380826     1.139066  0.090565138 
   90000   0.51262776   0.80028133    1.3129091 -0.026711684 
   91000   0.44538572   0.87718018    1.3225659  0.072735519 
   92000   0.62186959   0.77711383    1.3989834  0.036054345 
   93000    0.6072132   0.50254554    1.1097587   0.16970156 
   94000   0.53783501    0.4123695   0.95020451 -0.033797081 
   95000   0.60935209   0.66598092     1.275333   0.12624318 
   96000   0.66978482   0.63651858    1.3063034  0.083848209 
   97000   0.67347125   0.54537705    1.2188483 -0.053569936 
   98000   0.65331597    0.6111628    1.2644788  0.070938398 
   99000   0.63798885   0.62209473    1.2600836  0.065270142 
  100000   0.61624336   0.72001897    1.3362623  0.054009175 
Loop time of 7.34417 on 1 procs for 100000 steps with 32 atoms

Performance: 1176443.997 tau/day, 13616.250 timesteps/s
64.7% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.0535     | 2.0535     | 2.0535     |   0.0 | 27.96
Neigh   | 0.009219   | 0.009219   | 0.009219   |   0.0 |  0.13
Comm    | 0.080637   | 0.080637   | 0.080637   |   0.0 |  1.10
Output  | 4.1651     | 4.1651     | 4.1651     |   0.0 | 56.71
Modify  | 0.9839     | 0.9839     | 0.9839     |   0.0 | 13.40
Other   |            | 0.05186    |            |       |  0.71

Nlocal:    32 ave 32 max 32 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    20 ave 20 max 20 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    55 ave 55 max 55 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 55
Ave neighs/atom = 1.71875
Neighbor list builds = 2452
Dangerous builds = 0
Total wall time: 0:00:07
